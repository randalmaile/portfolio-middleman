(function(e,t,n){"use strict";function H(e,t){if(t&&t.onError){if(t.onError(e)===p){return}}this.name="JsRender Error";this.message=e||"JsRender error"}function B(e,t){var n;e=e||{};for(n in t){e[n]=t[n]}return e}function j(e,t,n){if(!ft.rTag||arguments.length){a=e?e.charAt(0):a;f=e?e.charAt(1):f;l=t?t.charAt(0):l;c=t?t.charAt(1):c;h=n||h;e="\\"+a+"(\\"+h+")?\\"+f;t="\\"+l+"\\"+c;o="(?:(?:(\\w+(?=[\\/\\s\\"+l+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))"+"\\s*((?:[^\\"+l+"]|\\"+l+"(?!\\"+c+"))*?)";ft.rTag=o+")";o=new RegExp(e+o+"(\\/)?|(?:\\/(\\w+)))"+t,"g");u=new RegExp("<.*>|([^\\\\]|^)[{}]|"+e+".*"+t)}return[a,f,l,c,h]}function F(e){var t=this,n=!e||e==="root";while(n&&t.parent.parent||t&&t.type!==e){t=t.parent}return t}function I(){var e=this.get("item");return e?e.index:n}function q(e){var t,r=this,i=(r.ctx||{})[e];i=i===n?r.getRsc("helpers",e):i;if(i){if(typeof i==="function"){t=function(){return i.apply(r,arguments)};B(t,i)}}return t||i}function R(e,t,n,r,i,s){if(e||i){var o,u=!n.markup&&n,a={tagName:e+":",tagCtx:r},f=r.args=M.call(arguments,5);r.view=t;r.bind=!!(u||i);if(u){u.tag=a;a.linkCtx=u;r.ctx=it(r.ctx,u.view.ctx)}a.ctx=r.ctx||{};r.props=r.props||{};delete r.ctx;if(e&&((o=t.getRsc("converters",e))||Y("Unknown converter: {{"+e+":"))){s=o.apply(a,f)}if(i){i=t.tmpl.bnds[i-1];u.paths=i;t._.tag=a;s=t._.onRender(s,t,d)}}return s}function U(e,t){var r,i=this,s=P[e];r=s&&s[t];while(r===n&&i){s=i.tmpl[e];r=s&&s[t];i=i.parent}return r}function z(e,t,n){var r=this,i=!n&&P[e];return i&&i[t]||(i=r.tmpl[e],i&&i[t])||r.parent&&r.parent.getRsc(e,t,d)}function W(e,t,r,i,s,o){var u,a,f,l,c,h,d=r.markup&&r,v=!d&&r,m=t._,g=d||t.tmpl,y=g.templates,b=t.getRsc("tags",e)||Y("Unknown tag: {{"+e+"}}"),w=s.args=arguments.length>6?M.call(arguments,6):[],E=s.props=s.props||{};s.view=t;s.ctx=it(s.ctx,t.ctx);f=s.ctx||{};delete s.ctx;d=E.tmpl;i=i&&g.tmpls[i-1];d=d||i||b.template||n;d=""+d===d?t.getRsc("templates",d)||st(d):d;if(e==="else"){c=t._.tag;l=c._elses=c._elses||[];l.push(d);s.isElse=l.length;a=c.render}if(b.init){h=f.tags=t.ctx&&it(f.tags,t.ctx.tags)||{};c=c||v.tag;if(c){h[e]=c}else{c=h[e]=new b.init(s,v,f);c.tmpl=d;if(v){c.attr=v.attr=v.attr||b.attr||""}}f.tag=c}else{c=c||{render:b.render,renderContent:G,tmpl:d,tagName:e}}c.tagCtx=s;c.ctx=f;if(v){v.tag=c;c.linkCtx=v}c._is="tag";c._done=s.isElse?c._done:p;d=d||c.tmpl;l=c._elses;m.tag=c;if(a=a||c.render){u=a.apply(c,w)}u=u!==n?u:d?c.renderContent(s.data!==n?s.data:t.data,n,t):"";return o?m.onRender(u,t,o):u}function X(e,t,r,i,s,o,u){var a,f,l=t==="array",c={key:0,useKey:l?0:1,id:""+N++,onRender:u,bnd:{}},h={data:i,tmpl:s,views:l?[]:{},parent:r,ctx:e,type:t,get:F,getIndex:I,getRsc:U,_hlp:q,_:c};if(r){a=r.views;f=r._;if(f.useKey){a[c.key="_"+f.useKey++]=h}else{a.splice(c.key=h.index=o!==n?o:a.length,0,h)}h.ctx=e||r.ctx}return h}function V(e){var t,n,r,i,s;for(t in D){i=D[t];if((s=i.compile)&&(n=e[t+"s"])){for(r in n){n[r]=s(r,n[r],e,t,i)}}}}function $(e,t,n){var r,i;if(typeof t==="function"){t={tagName:e,render:t,depends:t.depends}}else{t.tagName=e;if(i=t.template){t.template=""+i===i?st[i]||st(i):i}if(t.init!==p){r=t.init=t.init||function(e){};r.prototype=t;(r.prototype=t).constructor=r}}t.renderContent=G;t.attr="html";if(n){t._parentTmpl=n}return t}function J(e,r,i,s,o,a){function f(n){if(""+n===n||n.nodeType>0){try{c=n.nodeType>0?n:!u.test(n)&&t&&t(n)[0]}catch(r){}if(c){n=c.getAttribute(A);e=e||n;n=st[n];if(!n){e=e||"_"+T++;c.setAttribute(A,e);n=st[e]=J(e,c.innerHTML,i,s,o,a)}}return n}}var l,c;r=r||"";l=f(r);a=a||(r.markup?r:{});a.tmplName=e;if(i){a._parentTmpl=i}if(!l&&r.markup&&(l=f(r.markup))){if(l.fn&&(l.debug!==r.debug||l.allowCode!==r.allowCode)){l=l.markup}}if(l!==n){if(e&&!i){_[e]=function(){return r.render.apply(r,arguments)}}if(l.fn||r.fn){if(l.fn){if(e&&e!==l.tmplName){r=it(a,l)}else{r=l}}}else{r=K(l,a);et(l,r)}V(a);return r}}function K(e,t){var n,r=lt.wrapMap||{},s=B({markup:e,tmpls:[],links:{},bnds:[],render:G},t);if(!t.htmlTag){n=S.exec(e);s.htmlTag=n?n[1].toLowerCase():""}n=r[s.htmlTag];if(n&&n!==r.div){s.markup=i.trim(s.markup);s._elCnt=d}return s}function Q(e,t){function r(s,o,u){var a,f,l,c,h,p,d,v;if(s&&""+s!==s&&!s.nodeType&&!s.markup){for(c in s){r(c,s[c],o)}return P}d=u?u[i]=u[i]||{}:r;if(o===n){o=s;s=n}f=t.compile;if(a=ft.onBeforeStoreItem){f=a(d,s,o,f)||f}if(!s){o=f(n,o)}else if(""+s===s){if(o===null){delete d[s]}else{d[s]=f?o=f(s,o,u,e,t):o}}if(o){o._is=e}if(a=ft.onStoreItem){a(d,s,o,f)}return o}var i=e+"s";P[i]=r;D[e]=t}function G(e,t,r,s,o,u){var a,f,l,c,h,v,m,g,y,b,w,E,S=this,x=S,T=S.attr===n||S.attr==="html",N="";if(s===d){y=d;s=0}if(w=S._is==="tag"){b=S.tagCtx;x=b.isElse?S._elses[b.isElse-1]:S.tmpl;t=it(t,S.ctx);g=b.props;if(g.link===p){t=t||{};t.link=p}r=r||b.view}else{x=S.jquery&&(S[0]||Y('Unknown template: "'+S.selector+'"'))||S}if(x){if(r){u=u||r._.onRender;m=r.ctx;if(e===r){e=r.data;o=d}}t=it(t,m);if(!x.fn){x=st[x]||st(x)}if(x){u=(t&&t.link)!==p&&T&&u;E=u;if(u===d){E=n;u=r._.onRender}if(i.isArray(e)&&!o){c=y?r:s!==n&&r||X(t,"array",r,e,x,s,u);for(a=0,f=e.length;a<f;a++){l=e[a];h=X(t,"item",c,l,x,(s||0)+a,u);v=x.fn(l,h,P);N+=c._.onRender?c._.onRender(v,h):v}}else{c=y?r:X(t,S.tagName||"data",r,e,x,s,u);N+=x.fn(e,c,P)}return E?E(N,c):N}}return""}function Y(e){if(lt.debugMode){throw new P.sub.Error(e)}}function Z(e){Y("Syntax error\n"+e)}function et(e,t,n){function r(t){t-=l;if(t){h.push(e.substr(l,t).replace(g,"\\n"))}}function i(t){t&&Z('Unmatched or missing tag: "{{/'+t+'}}" in template:\n'+e)}function s(t,s,o,f,v,m,g,b,S,x,T,N){if(m){v=":";f="html"}var C,k,L=[],A="",O="",M="",_=!x&&!v&&!g&&!n;o=o||v;r(N);l=N+t.length;if(b){if(a){h.push(["*","\n"+S.replace(y,"$1")+"\n"])}}else if(o){if(o==="else"){if(E.test(S)){Z('for "{{else if expr}}" use "{{else expr}}"')}p[7]=e.substring(p[7],N);p=c.pop();h=p[3];_=d}if(S){S=S.replace(/\s*\n\s*/g," ");A=nt(S,L).replace(w,function(e,t,n){if(t){M+=n+","}else{O+=n+","}return""})}O=O.slice(0,-1);A=A.slice(0,-1);C=O&&O.indexOf("noerror:true")+1&&O||"";u=[o,f||"",A,_&&[],"{"+(O?"props:"+(C?"hsh":"{"+O+"}")+",":"")+'params:"'+S+'"'+(M?",ctx:{"+M.slice(0,-1)+"}":"")+"},",C,s&&L||0];h.push(u);if(_){c.push(p);p=u;p[7]=l}}else if(T){k=p[0];i(T!==k&&k&&k!=="else");p[7]=e.substring(p[7],N);p=c.pop()}i(!p&&T);h=p[3]}var u,a=t&&t.allowCode,f=[],l=0,c=[],h=f,p=[,,,f];e=e.replace(b,"\\$1");i(c[0]&&c[0][3].pop()[0]);e.replace(o,s);r(e.length);if(l=f[f.length-1]){i(""+l!==l&&+l[7]===l[7]&&l[0])}return tt(f,t)}function tt(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,v,m,g,y,b,w,E,S,x="",T={},N=e.length;if(t){if(w=t.allowCode){T.allowCode=d}if(t.debug){T.debug=d}m=t.bnds;y=t.tmpls}for(r=0;r<N;r++){i=e[r];n="";if(""+i===i){n='ret+="'+i+'";'}else{c=i[0];if(c==="*"){n=""+i[1]}else{h=i[1];p=i[2];E=i[3];v=i[4];o=i[5];g=i[6];S=i[7];if(E){b=K(S,T);tt(E,b);y.push(b)}if(g){m.push(g);g=m.length}l=l||v.indexOf("view")>-1;if(o){o="try{prm="+p+";hsh={"+o+'};}catch(e){prm="";hsh={};}\n';p="prm"}n+=o+"ret+="+(c===":"?h==="html"&&!g?(u=d,"h("+p+");"):h||g?(f=d,'c("'+h+'",view,this,'+v+g+","+p+");"):(a=d,"(v="+p+')!=u?v:"";'):(s=d,'t("'+c+'",view,this,'+(E?y.length:'""')+","+v+g+(p?",":"")+p)+");")}}x+="\n"+n}x=O+(o?"prm,hsh,":"")+(a?"v,":"")+(s?"t=j._tag,":"")+(f?"c=j._cnvt,":"")+(u?"h=j.converters.html,":"")+'ret="";\n'+(lt.tryCatch?"try{\n":"")+(T.debug?"debugger;":"")+x+"\nreturn ret;\n"+(lt.tryCatch?"\n}catch(e){return j._err(e);}":"");try{x=new Function("data, view, j, u",x)}catch(C){Z("Compiled template code:\n\n"+x,C)}if(t){t.fn=x}return x}function nt(e,t){function n(n,a,f,l,c,h,m,g,y,b,w,E,S,x,T,N){function C(e,n,r,i,s,o,u){if(n){t.push(l);if(n!=="."){var a,f=(r?'view._hlp("'+r+'")':i?"view":"data")+(u?(s?"."+s:r?"":i?"":"."+n)+(o||""):(u=r?"":i?s||"":n,""));a=u?"."+u:"";f=f+a;f=f.slice(0,9)==="view.data"?f.slice(5):f;return f}}return e}c=c||"";f=f||a||w;l=l||g;y=y||T||"";if(h){Z(e)}else{return u?(u=!E,u?n:'"'):o?(o=!S,o?n:'"'):(f?(s++,f):"")+(N?s?"":r?(r=p,"\b"):",":m?(s&&Z(e),r=d,"\b"+l+":"):l?l.split("^").join(".").replace(v,C)+(y?(i[++s]=d,y):c):c?c:x?(i[s--]=p,x)+(y?(i[++s]=d,y):""):b?(i[s]||Z(e),","):a?"":(u=E,o=S,'"'))}}var r,i={},s=0,o=p,u=p;t.expr=e.replace(y,"$1");return(e+" ").replace(m,n)}function rt(e){return C[e]||(C[e]="&#"+e.charCodeAt(0)+";")}function it(e,t){return e&&e!==t?t?B(B({},t),e):e:t&&B({},t)}if(t&&t.views||e.jsviews){return}var r="v1.0pre",i,s,o,u,a="{",f="{",l="}",c="}",h="^",p=false,d=true,v=/^(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,m=/(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)/g,g=/\r?\n/g,y=/\\(['"])/g,b=/([\\'"])/g,w=/\x08(~)?([^\x08]+)\x08/g,E=/^if\s/,S=/<(\w+)[>\s]/,x=/<(\w+)[^>\/]*>[^>]*$/,T=0,N=0,C={"&":"&","<":"&lt;",">":"&gt;"},k=/[<"'&]/g,L=/[\x00<>"'&]/g,A="data-jsv-tmpl",O="var j=j||"+(t?"jQuery.":"js")+"views,",M=[].slice,_={},D={template:{compile:J},tag:{compile:$},helper:{},converter:{}},P={jsviews:r,render:_,View:X,settings:{delimiters:j,debugMode:d,tryCatch:d},sub:{Error:H,tmplFn:et,parse:nt,extend:B,error:Y},_cnvt:R,_tag:W,_err:function(e){return lt.debugMode?"Error: "+(e.message||e)+". ":""}};(H.prototype=new Error).constructor=H;I.depends=function(e){return[e.get("item"),"index"]};for(s in D){Q(s,D[s])}var st=P.templates,ot=P.converters,ut=P.helpers,at=P.tags,ft=P.sub,lt=P.settings;if(t){i=t;i.render=_;i.views=P;i.templates=st=P.templates;i.fn.render=G}else{i=e.jsviews=P;i.isArray=Array&&Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}}at({"if":function(e){var t=this;return t._done||arguments.length&&!e?"":(t._done=true,t.renderContent(t.tagCtx.view))},"else":function(){},"for":function(){var e,t,r,s=this,o=s.tagCtx,u="",a=arguments,f=0,l=a.length;if(!l){return o.done?"":(o.done=d,s.renderContent(o.view))}for(e=0;e<l;e++){t=a[e];r=t===n;if(!r){f+=i.isArray(t)?t.length:1;u+=s.renderContent(t)}else{return""}}o.done=f;return u},"*":function(e){return e}});ot({html:function(e){return e!=n?String(e).replace(L,rt):""},attr:function(e){return e!=n?String(e).replace(k,rt):""},url:function(e){return e!=n?encodeURI(String(e)):""}});j()})(this,this.jQuery)